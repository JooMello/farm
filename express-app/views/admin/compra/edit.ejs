<%- include ("../../partials/header.ejs") %> <%- include
("../../partials/navbar.ejs") %>

<body>
  <br />  
    <div class="container">
      <br/>
      <div class="card">
        <div class="card-header">
      <h2>Editar Compra</h2>
    </div>
      <hr />
      <div class="card-body">
        <form method="POST" action="/compra/update">
          <div class="input--with-addon currency-input">
          <label>Nome</label>
           <input type="hidden" value="<%= compra.id %>" name="id" />
          <select name="investidor" class="form-control">
                    <% investidores.forEach((investidor) => { %>
                      <% if (investidor.id == compra.investidoreId) { %>
                        <option value="<%= investidor.id %>" selected><%= investidor.name %></option>
                        <% } else { %>
                          <option value="<%= investidor.id %>"><%= investidor.name %></option>
                          <% } %> 
                       <% }) %> 
                  </select>
          </div>
          <br />
          <div class="input--with-addon currency-input">
          <label>Data Compra</label>
          <input
            class="form-control"
            type="date"
            name="data"
            value="<%= compra.data %>"
            required
          />
          </div><br />
          <div class="input--with-addon currency-input">
            <label>Quantidade</label>
            <div class="input__container numeral-input">
              <input
                required="required"
                type="text"
                name="quantidade"
                id="quantidade"
                value="<%= compra.quantidade %>"
                class="input form-control form-control-danger"
              /><!---->
            </div>
            <!----><!---->
          </div>
          <br />
          <div class="input--with-addon currency-input">
            <label>Valor Unitário</label>
            <div class="input__container numeral-input">
              <input
                required="required"
                type="text"
                name="valor"
                id="valor"
                value="<%= compra.valor %>"
                class="input form-control form-control-danger"
              /><!---->
            </div>
            <!----><!---->
          </div>
          <br />
          <div class="input--with-addon currency-input">
            <label>Dolar</label>
            <div class="input__container numeral-input">
              <input
                required="required"
                type="text"
                name="dolar"
                value="<%= compra.dolar %>"
                class="input form-control form-control-danger"
              /><!---->
            </div>
            <!----><!---->
          </div>
          <br />
          <div class="input--with-addon currency-input">
            <label>Compra - Dolar</label>
            <div class="input__container numeral-input">
              <input
                required="required"
                type="text"
                name="amount"
                id="amount"
                value="<%= compra.amount %>"
                class="input form-control form-control-danger"
              /><!---->
            </div>
            <!----><!---->
          </div>
          <br />
          <div class="input--with-addon currency-input">
            <label>Descrição</label>
            <div class="input__container text-input">
              <textarea type="text" name="obs" id="obs" required class="input form-control form-control-danger"><%= compra.obs %></textarea>
            </div>
            <!----><!---->
          </div>
          <br />
          <button class="btn btn-success">Atualizar</button>
        </form>
      </div>

      </div>
      <br />  
      </div>
      </body>


<%- include ("../../partials/footer.ejs") %>




<script>

  //filtragem de dados, por peridodo que eles foram adicionados no BD
//formatar numeros em valores decimais (.toLocaleFixed(2))
Number.prototype.toLocaleFixed = function (n) {
return this.toLocaleString(undefined, {
  minimumFractionDigits: n,
  maximumFractionDigits: n
});
};
/////
var unitario = <%= compra.unitario %>;
document.getElementById('unitario').value = Number(unitario).toLocaleFixed(2);
/////
/////
var total = <%= compra.total %>;
document.getElementById('total').value = Number(total).toLocaleFixed(2);
/////
var amount = <%= compra.amount %>;
document.getElementById('amount').value = Number(amount).toLocaleFixed(2);
/////
</script>

<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script src="https://plentz.github.io/jquery-maskmoney/javascripts/jquery.maskMoney.min.js" type="text/javascript"></script>

<script>
  jQuery(function() {
      
      jQuery("#unitario").maskMoney({
    thousands:'.', 
    decimal:','
  })
  
  });
  </script>
