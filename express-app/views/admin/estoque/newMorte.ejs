<%- include ("../../partials/header.ejs") %> <%- include
("../../partials/navbar.ejs") %>

<body>
  <br/>
    <div class="container">
      <br/>
        <div class="card">
            <div class="card-header">
              <h2>Mortes</h2>
            </div>
            <div class="card-body">
                <form method="POST" action="/morte/save">
                    <div class="input--with-addon currency-input">
                  <label>Nome </label>
                  <div class="input__container text-input">
                    <select name="investidor" class="form-control">
                      <% investidores.forEach((investidor) => { %>
                        <option value="<%= investidor.id %>"><%= investidor.name %></option>
                        <% }) %> 
                    </select>
                    </div>
                    </div>
                  <br />
                  <div class="input--with-addon currency-input">
                    <label>Data Morte</label>
                    <div class="input__container numeral-input">
                      <input
                        type="date"
                        name="data"
                        required
                        class="input form-control form-control-danger"
                      /><!---->
                    </div>
                    <!----><!---->
                  </div>
                  <br>
                  <div class="input--with-addon currency-input">
                      <label>Quantidade</label>
                      <div class="input__container text-input">
                        <input
                          type="text"
                          name="quantidade"      
                          required     
                          class="input form-control form-control-danger"
                        /><!---->
                      </div>
                      <!----><!---->
                    </div>
                  <br />
                  <div class="input--with-addon currency-input">
                    <label>Valor</label>
                    <div class="input__container text-input">
                      <input type="text" name="valor" id="valor" required class="input form-control form-control-danger"
                        onkeyup="formatCurrency(this)" /><!---->
                    </div>
                    <!----><!---->
                  </div>
                <br />
                  <div class="row">
                    <div class="col"></div>
                    <div class="col-3"> 
                      <button class="btn btn-success form-control">Salvar</button>
                      </div>
                    </div>
                </form>
              </div>
          </div>
          <br />  
      </div>



      </body>


<%- include ("../../partials/footer.ejs") %>
<!-- script pegar valores (quantidade, unitario) multiplicar e apresentar no input total.
Pega valor total da compra divide pelo dolar diario
-->
<script>
  const valorInput = document.getElementById('valor');

  valorInput.addEventListener('input', event => {
    // Remove todos os caracteres não numéricos do valor de entrada
    const valorNumerico = event.target.value.replace(/[^\d]/g, '');

    // Formata o valor numérico como um valor de dinheiro
    const valorFormatado = new Intl.NumberFormat('pt-BR', { style: 'currency', currency: 'BRL' }).format(valorNumerico / 100);

    // Define o valor formatado no input
    event.target.value = valorFormatado;

    // Sua lógica de cálculo de conversão de moeda abaixo
    const unitarioValue = valorNumerico / 100;

    const dolar = <%= cotacao %>;

    const totalDolarValue = (Number(unitarioValue) / Number(dolar))
    document.getElementById('amount').value = Number(totalDolarValue).toLocaleString('en-US', { style: 'currency', currency: 'USD' });
  });

</script>


<script src="//ajax.googleapis.com/ajax/libs/jquery/1.10.2/jquery.min.js" type="text/javascript"></script>
<script src="https://plentz.github.io/jquery-maskmoney/javascripts/jquery.maskMoney.min.js"
  type="text/javascript"></script>